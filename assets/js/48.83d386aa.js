(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{550:function(a,e,t){"use strict";t.r(e);var s=t(2),r=Object(s.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("p",[a._v("由于经常会去制作一下，干脆记下来。")]),a._v(" "),e("p",[a._v("Let'sEncrypt 官网：https://letsencrypt.org/\ncertbot 地址：https://github.com/certbot/certbot")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://pico.oss-cn-hangzhou.aliyuncs.com/uPic/GNq2G4.png",alt:""}})]),a._v(" "),e("h3",{attrs:{id:"安装准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装准备"}},[a._v("#")]),a._v(" 安装准备")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("对于 Mac 环境，直接 homebrew 安装 certbot 即可。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("brew install certbot --verbose\n")])])])]),a._v(" "),e("li",[e("p",[a._v("准备目录。")]),a._v(" "),e("ul",[e("li",[a._v("新建个工作目录，进入到当前目录；")]),a._v(" "),e("li",[a._v("新建 "),e("code",[a._v("config")]),a._v(", "),e("code",[a._v("logs")]),a._v(", "),e("code",[a._v("work")]),a._v(" 文件夹。")])])])]),a._v(" "),e("h3",{attrs:{id:"制作证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#制作证书"}},[a._v("#")]),a._v(" 制作证书")]),a._v(" "),e("p",[a._v("一行命令即可：")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("certbot certonly "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--manual")]),a._v(" --preferred-challenges"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("dns "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--server")]),a._v(" https://acme-v02.api.letsencrypt.org/directory "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    --agree-tos "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    --config-dir "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("/config "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    --work-dir "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("/work "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    --logs-dir "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("/logs "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*.ruogoo.cn"')]),a._v("\n")])])]),e("p",[a._v("第一次，会提示输入接收提醒的邮箱，询问是否公开邮箱、是否记录 IP 等，不允许就会退出。")]),a._v(" "),e("p",[a._v("然后，设置 DNS 的 TXT 解析 _acme-challenge")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("Please deploy a DNS TXT record under the name\n_acme-challenge.ruogoo.cn with the following value:\n\nGcdGo4s_vX2xoF4Bb5wSJF3icpm2oJlxRQGoeSxWRjs\n\nBefore continuing, verify the record is deployed.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nPress Enter to Continue\n")])])]),e("p",[a._v("设置解析完后，Enter 继续。")]),a._v(" "),e("p",[a._v("等待数秒，完成后，在 "),e("code",[a._v("./config/live/")]),a._v(" 目录里会有域名对应的公钥 "),e("code",[a._v("fullchain.pem")]),a._v(" 和私钥 "),e("code",[a._v("privkey.pem")]),a._v("。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("➜  certs tree config/live\nconfig/live\n├── README\n└── ruogoo.cn\n    ├── README\n    ├── cert.pem -> ../../archive/ruogoo.cn/cert1.pem\n    ├── chain.pem -> ../../archive/ruogoo.cn/chain1.pem\n    ├── fullchain.pem -> ../../archive/ruogoo.cn/fullchain1.pem\n    └── privkey.pem -> ../../archive/ruogoo.cn/privkey1.pem\n\n1 directory, 6 files\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);