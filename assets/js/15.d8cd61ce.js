(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{567:function(e,a,t){"use strict";t.r(a);var s=t(11),n=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[e._v("由于经常会去制作一下，干脆记下来。")]),e._v(" "),t("p",[e._v("Let'sEncrypt 官网：https://letsencrypt.org/\ncertbot 地址：https://github.com/certbot/certbot")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://pico.oss-cn-hangzhou.aliyuncs.com/uPic/GNq2G4.png",alt:""}})]),e._v(" "),t("h3",{attrs:{id:"安装准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装准备"}},[e._v("#")]),e._v(" 安装准备")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("对于 Mac 环境，直接 homebrew 安装 certbot 即可。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("brew install certbot --verbose\n")])])])]),e._v(" "),t("li",[t("p",[e._v("准备目录。")]),e._v(" "),t("ul",[t("li",[e._v("新建个工作目录，进入到当前目录；")]),e._v(" "),t("li",[e._v("新建 "),t("code",[e._v("config")]),e._v(", "),t("code",[e._v("logs")]),e._v(", "),t("code",[e._v("work")]),e._v(" 文件夹。")])])])]),e._v(" "),t("h3",{attrs:{id:"制作证书"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#制作证书"}},[e._v("#")]),e._v(" 制作证书")]),e._v(" "),t("p",[e._v("一行命令即可：")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("certbot certonly --manual --preferred-challenges"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("dns "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --server https://acme-v02.api.letsencrypt.org/directory "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --agree-tos "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --config-dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v("/config "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --work-dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v("/work "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --logs-dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v("/logs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    -d "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"*.ruogoo.cn"')]),e._v("\n")])])]),t("p",[e._v("第一次，会提示输入接收提醒的邮箱，询问是否公开邮箱、是否记录 IP 等，不允许就会退出。")]),e._v(" "),t("p",[e._v("然后，设置 DNS 的 TXT 解析 _acme-challenge")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Please deploy a DNS TXT record under the name\n_acme-challenge.ruogoo.cn with the following value:\n\nGcdGo4s_vX2xoF4Bb5wSJF3icpm2oJlxRQGoeSxWRjs\n\nBefore continuing, verify the record is deployed.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nPress Enter to Continue\n")])])]),t("p",[e._v("设置解析完后，Enter 继续。")]),e._v(" "),t("p",[e._v("等待数秒，完成后，在 "),t("code",[e._v("./config/live/")]),e._v(" 目录里会有域名对应的公钥 "),t("code",[e._v("fullchain.pem")]),e._v(" 和私钥 "),t("code",[e._v("privkey.pem")]),e._v("。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("➜  certs tree config/live\nconfig/live\n├── README\n└── ruogoo.cn\n    ├── README\n    ├── cert.pem -> ../../archive/ruogoo.cn/cert1.pem\n    ├── chain.pem -> ../../archive/ruogoo.cn/chain1.pem\n    ├── fullchain.pem -> ../../archive/ruogoo.cn/fullchain1.pem\n    └── privkey.pem -> ../../archive/ruogoo.cn/privkey1.pem\n\n1 directory, 6 files\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);